<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mera Hybrid Music Player</title>
    <style>
        /* Dark Theme CSS - Ismein koi badlaav nahi hai */
        :root {
            --primary-color: #007bff;
            --primary-color-light: #52a5ff;
            --background-color: #1e1e1e;
            --player-bg-color: #2c2c2c;
            --text-color: #ffffff;
            --text-color-light: #a0a0a0;
            --button-bg-color: #404040;
            --button-hover-bg-color: #555555;
            --disabled-color: #666666;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--background-color); color: var(--text-color); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        .music-player-container { background: var(--player-bg-color); padding: 25px 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); width: 90%; max-width: 380px; text-align: center; border: 1px solid #444; }
        #song-image { width: 180px; height: 180px; border-radius: 50%; object-fit: cover; margin: 0 auto 20px auto; border: 5px solid var(--button-bg-color); }
        .rotate { animation: spin 8s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .song-title { font-size: 22px; font-weight: 600; margin-bottom: 20px; min-height: 50px; display: flex; align-items: center; justify-content: center; }
        audio { display: none; }
        .navigation-controls { display: flex; justify-content: center; align-items: center; gap: 20px; margin-top: 15px; }
        .nav-button { background-color: var(--button-bg-color); border: none; border-radius: 50%; width: 50px; height: 50px; font-size: 20px; cursor: pointer; color: var(--text-color); display: flex; justify-content: center; align-items: center; transition: all 0.2s; }
        .nav-button:hover { background-color: var(--button-hover-bg-color); }
        #play-pause-btn { width: 65px; height: 65px; font-size: 28px; background-color: var(--primary-color); color: white; }
        .download-button { display: inline-block; background-color: var(--primary-color); color: #ffffff; padding: 12px 30px; text-decoration: none; border-radius: 50px; font-weight: bold; margin-top: 25px; transition: all 0.3s; }
        .download-button.disabled { background-color: var(--disabled-color); color: #999; cursor: not-allowed; }
        .youtube-input-group { display: flex; gap: 10px; margin-top: 20px; }
        #youtube-url { flex-grow: 1; padding: 10px 15px; border-radius: 20px; border: 1px solid #555; background: #333; color: var(--text-color); }
        #youtube-url:disabled { background-color: #222; cursor: not-allowed; }
        #play-yt-btn { padding: 10px 15px; border: none; border-radius: 20px; background-color: #ff0000; color: #fff; font-weight: bold; cursor: pointer; }
        #play-yt-btn:disabled { background-color: #8c0000; cursor: not-allowed; }
    </style>
</head>
<body>

    <div class="music-player-container">
        <img src="https://i.imgur.com/JFHwTzF.png" id="song-image" alt="Album Art">
        <div id="song-title" class="song-title">Player Load Ho Raha Hai...</div>
        
        <audio id="audio-player"></audio>
        <div id="youtube-player" style="position: absolute; top: -9999px; left: -9999px;"></div>

        <div class="navigation-controls">
            <button id="prev-btn" class="nav-button">◀◀</button>
            <button id="play-pause-btn" class="nav-button">▶</button>
            <button id="next-btn" class="nav-button">▶▶</button>
        </div>
        
        <a id="download-link" href="#" class="download-button" download>Gaana Download Karein</a>

        <div class="youtube-input-group">
            <input type="text" id="youtube-url" placeholder="YouTube Player taiyar ho raha hai..." disabled>
            <button id="play-yt-btn" disabled>Play</button>
        </div>
    </div>

    <script src="https://www.youtube.com/iframe_api"></script>
    
    <script>
        // === ELEMENTS ===
        const audioPlayer = document.getElementById('audio-player');
        const songImage = document.getElementById('song-image');
        const songTitle = document.getElementById('song-title');
        const downloadLink = document.getElementById('download-link');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const ytUrlInput = document.getElementById('youtube-url');
        const ytPlayBtn = document.getElementById('play-yt-btn');

        // === PLAYLIST & STATE ===
        const myPlaylist = [
            { type: 'mp3', title: 'Pehla Gaana', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3', image: 'https://i.imgur.com/3Q3SoKk.png', download: '#' },
            { type: 'mp3', title: 'Doosra Gaana', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3', image: 'https://i.imgur.com/5uC8x2s.png', download: '#' }
        ];
        let currentPlaylist = [...myPlaylist];
        let currentSongIndex = 0;
        let ytPlayer;
        let isPlaying = false;
        let isYTPlayerReady = false;

        // === INITIALIZATION ===
        document.addEventListener('DOMContentLoaded', initPlayer);

        function initPlayer() {
            // Player ko turant MP3 ke saath shuru karo
            loadSong(currentSongIndex);
            setupEventListeners();
        }

        function setupEventListeners() {
            playPauseBtn.addEventListener('click', togglePlayPause);
            prevBtn.addEventListener('click', playPrevSong);
            nextBtn.addEventListener('click', playNextSong);
            ytPlayBtn.addEventListener('click', addYouTubeSong);
            audioPlayer.addEventListener('play', () => setIsPlaying(true));
            audioPlayer.addEventListener('pause', () => setIsPlaying(false));
            audioPlayer.addEventListener('ended', playNextSong);
        }

        // === YOUTUBE API CALLBACKS ===
        function onYouTubeIframeAPIReady() {
            ytPlayer = new YT.Player('youtube-player', {
                events: { 'onReady': onPlayerReady, 'onStateChange': onPlayerStateChange }
            });
        }
        
        function onPlayerReady(event) {
            isYTPlayerReady = true;
            ytUrlInput.disabled = false;
            ytPlayBtn.disabled = false;
            ytUrlInput.placeholder = 'YouTube link yahan daalein';
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                const videoData = ytPlayer.getVideoData();
                songTitle.textContent = videoData.title;
                currentPlaylist[currentSongIndex].title = videoData.title;
                setIsPlaying(true);
            } else if (event.data === YT.PlayerState.PAUSED) {
                setIsPlaying(false);
            } else if (event.data === YT.PlayerState.ENDED) {
                playNextSong();
            }
        }
        
        // === CORE PLAYER LOGIC ===
        function loadSong(index) {
            currentSongIndex = index;
            const song = currentPlaylist[index];
            
            setIsPlaying(false);
            songTitle.textContent = song.title;
            songImage.src = song.image;

            if (song.type === 'mp3') {
                audioPlayer.src = song.src;
                downloadLink.classList.remove('disabled');
                downloadLink.href = song.download;
            } else {
                downloadLink.classList.add('disabled');
                downloadLink.href = '#';
                if (isYTPlayerReady) {
                    ytPlayer.cueVideoById(song.id);
                }
            }
        }

        function togglePlayPause() {
            if (isPlaying) pauseSong();
            else playSong();
        }

        function playSong() {
            const song = currentPlaylist[currentSongIndex];
            if (song.type === 'mp3') {
                audioPlayer.play();
            } else if (song.type === 'youtube' && isYTPlayerReady) {
                ytPlayer.playVideo();
            }
        }

        function pauseSong() {
            const song = currentPlaylist[currentSongIndex];
            if (song.type === 'mp3') {
                audioPlayer.pause();
            } else if (song.type === 'youtube' && isYTPlayerReady) {
                ytPlayer.pauseVideo();
            }
        }

        function setIsPlaying(state) {
            isPlaying = state;
            playPauseBtn.innerHTML = state ? '❚❚' : '▶'; // Pause : Play
            songImage.classList.toggle('rotate', state);
        }

        function playNextSong() {
            currentSongIndex = (currentSongIndex + 1) % currentPlaylist.length;
            loadSong(currentSongIndex);
            playSong();
        }

        function playPrevSong() {
            currentSongIndex = (currentSongIndex - 1 + currentPlaylist.length) % currentPlaylist.length;
            loadSong(currentSongIndex);
            playSong();
        }

        function addYouTubeSong() {
            const url = ytUrlInput.value;
            const videoId = url.match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);
            
            if (videoId && videoId[1]) {
                const newSong = {
                    type: 'youtube',
                    id: videoId[1],
                    title: 'YouTube Gaana (Loading...)',
                    image: `https://i.ytimg.com/vi/${videoId[1]}/hqdefault.jpg`
                };
                currentPlaylist.push(newSong);
                ytUrlInput.value = '';
                loadSong(currentPlaylist.length - 1);
                playSong();
            } else {
                alert('Yeh ek valid YouTube link nahi hai.');
            }
        }
    </script>
</body>
</html>
